<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.62">
    <title>KernelCare Enterprise</title><meta name="description" content="">
    <link rel="preload" href="/assets/style-d73089ea.css" as="style"><link rel="stylesheet" href="/assets/style-d73089ea.css">
    <link rel="modulepreload" href="/assets/app-d6b3729a.js"><link rel="modulepreload" href="/assets/index.html-77485196.js"><link rel="modulepreload" href="/assets/index.html-c0585b8f.js"><link rel="modulepreload" href="/assets/uchecker-31d683fa.js"><link rel="modulepreload" href="/assets/eportal-qemu-feed-7c9efdb9.js"><link rel="prefetch" href="/assets/index.html-e8171bcc.js" as="script"><link rel="prefetch" href="/assets/index.html-bcc0f37f.js" as="script"><link rel="prefetch" href="/assets/index.html-ca30062c.js" as="script"><link rel="prefetch" href="/assets/index.html-ae0b2092.js" as="script"><link rel="prefetch" href="/assets/index.html-5881d23a.js" as="script"><link rel="prefetch" href="/assets/index.html-86f6d09c.js" as="script"><link rel="prefetch" href="/assets/index.html-092f14d9.js" as="script"><link rel="prefetch" href="/assets/index.html-e1c111f0.js" as="script"><link rel="prefetch" href="/assets/index.html-92daca91.js" as="script"><link rel="prefetch" href="/assets/index.html-6c9650cc.js" as="script"><link rel="prefetch" href="/assets/index.html-1b83a534.js" as="script"><link rel="prefetch" href="/assets/index.html-424fedbf.js" as="script"><link rel="prefetch" href="/assets/index.html-bfb306f5.js" as="script"><link rel="prefetch" href="/assets/index.html-131d62e8.js" as="script"><link rel="prefetch" href="/assets/index.html-91ab7eda.js" as="script"><link rel="prefetch" href="/assets/index.html-45ca0bbf.js" as="script"><link rel="prefetch" href="/assets/index.html-7edc8259.js" as="script"><link rel="prefetch" href="/assets/index.html-270136ce.js" as="script"><link rel="prefetch" href="/assets/index.html-03ae4051.js" as="script"><link rel="prefetch" href="/assets/404.html-e0575d4e.js" as="script"><link rel="prefetch" href="/assets/index.html-281e9233.js" as="script"><link rel="prefetch" href="/assets/index.html-d4aecf17.js" as="script"><link rel="prefetch" href="/assets/index.html-d9a1aaf9.js" as="script"><link rel="prefetch" href="/assets/index.html-a0b56b04.js" as="script"><link rel="prefetch" href="/assets/index.html-439668fc.js" as="script"><link rel="prefetch" href="/assets/index.html-f57fe3e8.js" as="script"><link rel="prefetch" href="/assets/index.html-1c407a1b.js" as="script"><link rel="prefetch" href="/assets/index.html-f35ca88e.js" as="script"><link rel="prefetch" href="/assets/index.html-e2309e8b.js" as="script"><link rel="prefetch" href="/assets/index.html-c027714e.js" as="script"><link rel="prefetch" href="/assets/index.html-3df3dc93.js" as="script"><link rel="prefetch" href="/assets/index.html-28f2468d.js" as="script"><link rel="prefetch" href="/assets/index.html-295be1af.js" as="script"><link rel="prefetch" href="/assets/index.html-7c6e6f78.js" as="script"><link rel="prefetch" href="/assets/index.html-59a8f018.js" as="script"><link rel="prefetch" href="/assets/index.html-962df962.js" as="script"><link rel="prefetch" href="/assets/index.html-f9791e3a.js" as="script"><link rel="prefetch" href="/assets/index.html-cce67874.js" as="script"><link rel="prefetch" href="/assets/index.html-e1f62d5a.js" as="script"><link rel="prefetch" href="/assets/404.html-1e5f2525.js" as="script"><link rel="prefetch" href="/assets/docsearch.min-8c6f14d8.js" as="script"><link rel="prefetch" href="/assets/docsearch.min-49eb4b49.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><header class="navbar fixed"><div class="navbar-header"><div class="navbar-header__logo-wrapper"><a href="/" class="home-link"><img class="logo" src="/global/logo.svg" alt="logo header"></a><div class="header-layout__search-container"><!----><form id="search-form" class="drawer-header__input"><input value="" id="algolia-search-input" placeholder="Search" class="header-layout__search-default"><div class="header-layout__search-icon-default"><img alt="search icon" src="/global/search.svg"></div></form><div><div class="drawer"><div class="drawer-header"><div class="drawer-header__wrapper"><h2 class="drawer-header__paragraph">How can we help you?</h2><div id="drawerSearch"></div></div><div class="drawer-cross"><img class="drawer-cross__img" src="/global/cross.svg" alt="cross"><p class="drawer-cross__text">close</p></div></div><div class="drawer-tabs__wrapper" data-v-3791b529><!--[--><!--]--></div><main class="drawer-main"><div class="drawer-main__wrapper"><div class="drawer-main__breadcrumb"><!----></div><!--[--><!----><div style="--7dd2d39a:5;"><p class="no_results">What are you searching for?</p></div><!--]--><div class="back-to-top" data-v-f6429ccb><a class="nav-arrow top back-to-top__link" data-v-f6429ccb><span class="back-to-top__link-span" data-v-f6429ccb>Scroll up</span></a></div></div></main></div><!----></div></div></div><div class="links" style="max-width:nullpx;"><div class="header-products-wrapper"><div class="dropdown"><!----><div class="header-products-container"><p class="header-products-wrapper-paragraph">Products</p><img class="products-icon__default" width="10" height="8" src="/arrows/arrow-down.svg" alt="arrow down icon"></div></div></div><a href="https://www.cloudlinux.com/support-portal/" target="_blank" class="btn">Submit support request</a><a href="https://cloudlinux.com/trial" target="_blank" class="btn btn-free">Try Free</a></div></div><!----></header><!----><div class="page"><!--[--><!--]--><div class="breadcrumb-wrapper page-breadcrumb" data-v-9445381a><span class="breadcrumb-title" data-v-9445381a>Documentation:</span><!--[--><a aria-current="page" href="/live-patching-services/" class="router-link-active router-link-exact-active breadcrumb" data-v-9445381a>KernelCare Enterprise</a><!--]--></div><div class="page-nav-wrapper"><!----></div><div class="content" custom="false"><h1 id="kernelcare-enterprise" tabindex="-1"><a class="header-anchor" href="#kernelcare-enterprise" aria-hidden="true">#</a> KernelCare Enterprise</h1><p>KernelCare Enterprise live patching enhances your vulnerability patching program by providing live patches to the Linux kernel and, optionally, with add-ons to critical userspace components, as well as the virtualization stack. The systems are patched according to your patch deployment policy, allowing you to customize your patch management to align with the needs of your unique environment, whether online or in an air-gapped environment. Plus, your vulnerability reports reduce in size quickly as KernelCare seamlessly integrates with all popular vulnerability scanners to give you an accurate vulnerability exposure report.</p><p>KernelCare Enterprise brings KernelCare live patching by default and the following add-ons:</p><ul><li>LibCare</li><li>QEMUCare</li></ul><p>The sections below describe KernelCare live patching and the additional add-ons in more detail.</p><h2 id="kernelcare" tabindex="-1"><a class="header-anchor" href="#kernelcare" aria-hidden="true">#</a> KernelCare</h2><h3 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction" aria-hidden="true">#</a> Introduction</h3><p>KernelCare Enterprise is a live kernel patching service that provides security patches and bugfixes for a range of popular Linux kernels that can be installed without rebooting the system</p><h3 id="benefits" tabindex="-1"><a class="header-anchor" href="#benefits" aria-hidden="true">#</a> Benefits</h3><p>Today, system administrators have to reboot a server to apply the latest kernel updates. These updates are necessary to prevent security issues. Due to downtime associated with reboots, however, such updates are often delayed, pushed into the darkest hours of the night. It is common for server owners to not update their systems for months or even years and to run vulnerable systems to avoid downtime. Managed service providers face the problem of having to schedule downtime and then updating and rebooting thousands of servers in a short period of time, straining resources. KernelCare solves this update and reboot issue by providing live kernel patching without the need for a reboot</p><h3 id="key-features" tabindex="-1"><a class="header-anchor" href="#key-features" aria-hidden="true">#</a> Key Features</h3><ul><li>Rebootless Linux Kernel Patching &amp; Custom Patching</li><li>Works On-prem &amp; in the cloud</li><li>Private patch server for gated infrastructures - ePortal</li><li>Out-of-the-box integration with patch management &amp; vulnerability assessment tools</li></ul><h3 id="getting-trial-license" tabindex="-1"><a class="header-anchor" href="#getting-trial-license" aria-hidden="true">#</a> Getting trial license</h3><p>You will need a trial activation key to be able to use the KernelCare Enterprise. The trial license subscription will work for 7 days.</p><p>If you have any issues getting activation key or if you have any questions regarding using your trial subscription â€“ contact <a href="mailto:sales@cloudlinux.com">sales@cloudlinux.com</a> and we will help.</p><h3 id="installation" tabindex="-1"><a class="header-anchor" href="#installation" aria-hidden="true">#</a> Installation</h3><p>KernelCare Enterprise is compatible with 64-bit versions of CloudLinuxOS/CentOS 6,7, and 8, AlmaLinux/RHEL 6,7,8, and 9, Oracle Linux 6 and 7, Amazon Linux 1 and 2, Virtuozzo/PCS/OpenVZ 2.6.32, Debian 8,9 and 10, Proxmox VE 5 and 6, Virt-SIG/Xen4CentOS 6 and 7, Ubuntu 14.04, 15.04, 16.04, 18.04 and 20.04 kernels. The list of compatible kernels can be found on the following link: <a href="https://patches.kernelcare.com/" target="_blank" rel="noopener noreferrer">https://patches.kernelcare.com/</a> .</p><p>To install KernelCare Enterprise, run:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>curl -s -L https://kernelcare.com/installer | bash
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>or:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>wget -qq -O - https://kernelcare.com/installer | bash
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>If you are using IP-based license, nothing else required to be done.</p><p>If you are using key-based license, run:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ /usr/bin/kcarectl --register KEY
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>KEY</code> is the registration key code string provided when you sign up for purchase or trial of the product.</p><p>If you are experiencing <strong><em>Key limit reached</em></strong> error after the end of the trial period you should first, unregister the server by running:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>kcarectl --unregister
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>To check if patches applied, run:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ /usr/bin/kcarectl --info
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>The software will automatically check for new patches every 4 hours.</p><p>If you would like to run update manually:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ /usr/bin/kcarectl --update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>To check current kernel compatibility with KernelCare, use the following <a href="https://raw.githubusercontent.com/iseletsk/kernelchecker/master/py/kc-compat.py" target="_blank" rel="noopener noreferrer">script</a> by running:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>curl -s -L https://kernelcare.com/checker | python
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>or:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>wget -qq -O - https://kernelcare.com/checker | python
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="update" tabindex="-1"><a class="header-anchor" href="#update" aria-hidden="true">#</a> Update</h3><p>To update the agent package to the latest version use:</p><ul><li>For rpm-based distributives (CentOS, RedHat, etc):</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>yum install -y kernelcare
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>For apt-based distributives (Debian, Ubuntu, etc):</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>apt-get install kernelcare
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="uninstalling" tabindex="-1"><a class="header-anchor" href="#uninstalling" aria-hidden="true">#</a> Uninstalling</h3><p>To uninstall KernelCare Enterprise, do the the following:</p><p><em>For CloudLinux, CentOS, RHEL, Virtuozzo, OpenVZ:</em></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ yum remove kernelcare
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><em>For Ubuntu, Debian, Proxmox VE:</em></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>apt-get remove kernelcare
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>dpkg --remove kernelcare
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>This will also unlink the system from its activation key (provided there is network connectivity to the CLN Portal). However, you&#39;ll need to remove the license from the CLN Portal manually if you don&#39;t plan to use the service anymore.</p><h3 id="switching-from-ksplice" tabindex="-1"><a class="header-anchor" href="#switching-from-ksplice" aria-hidden="true">#</a> Switching from Ksplice</h3><p>To switch from Ksplice to KernelCare Enterprise, use the following script that uninstalls Ksplice and installs KernelCare Enterprise instead.</p><p>It will automatically detect and abort if the system is not 64-bit (as KernelCare Enterprise doesn&#39;t support it).</p><p>It will also detects when Ksplice module cannot be uninstalled and retries multiple times.</p><p>Download the script here: <a href="https://patches.kernelcare.com/ksplice2kcare" target="_blank" rel="noopener noreferrer">https://patches.kernelcare.com/ksplice2kcare</a>.</p><p>Run the command:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ bash ksplice2kcare $KERNELCARE_KEY$
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>The key can be created/retrieved in KernelCare Enterprise Keys section of CLN.</p><p>If you want to use IP based licenses, run:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ bash ksplice2kcare IP
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>You have to add IP license for that server, and it is just two letters: IP, not the actual IP.</p><p>By default the script will attempt 3 times to uninstall Ksplice, waiting 60 seconds in between. You can run it using <code>nohup</code> if you don&#39;t want to wait.</p><p>You can change that by editing the script and changing <code>RETRY</code> and <code>SLEEP</code> values.</p><p>The script will exit with exit code <code>0</code> and message <em>Done</em> on success. Otherwise, it will produce exit code <code>-1</code>.</p><p>Complete log file can be found at <code>/var/log/ksplice2kcare.log</code>.</p><h4 id="canonical-livepatch" tabindex="-1"><a class="header-anchor" href="#canonical-livepatch" aria-hidden="true">#</a> Canonical Livepatch</h4><p>KernelCare Enterprise is not compatible with Canonical Livepatch and should not be used on the same system.</p><h3 id="basic-management" tabindex="-1"><a class="header-anchor" href="#basic-management" aria-hidden="true">#</a> Basic management</h3><p>To disable automatic updates, edit the file <code>/etc/sysconfig/kcare/kcare.conf</code></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>AUTO_UPDATE=False 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>To check the updated (&#39;effective&#39;) version, run:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ /usr/bin/kcarectl --uname 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>We provide convenience script <code>/usr/bin/kcare-uname</code> that has same syntax as <code>uname</code>.</p><p>To see applied patches, run:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ /usr/bin/kcarectl --patch-info 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="command-line-tools" tabindex="-1"><a class="header-anchor" href="#command-line-tools" aria-hidden="true">#</a> Command line tools</h3><p><code>/usr/bin/kcarectl</code> - Manage KernelCare Enterprise patches for your kernel.</p><p><code>/usr/bin/kcare-uname</code> - Print certain system information.</p><h4 id="kcarectl" tabindex="-1"><a class="header-anchor" href="#kcarectl" aria-hidden="true">#</a> kcarectl</h4><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><code>-i, --info</code></td><td>Display information about patches installed by KernelCare Enterprise.</td></tr><tr><td><code>-u, --update </code></td><td>Download latest patches, and apply them to current kernel.</td></tr><tr><td><code>--smart-update [since 1.6] </code></td><td>The same as --update, but uses <a aria-current="page" href="/live-patching-services/#config-options" class="router-link-active router-link-exact-active">UPDATE_POLICY</a> to decide where to get patches.</td></tr><tr><td><code>--unload</code></td><td>Unload patches.</td></tr><tr><td><code>--auto-update</code></td><td>Check if update is needed and update.</td></tr><tr><td><code>--patch-info</code></td><td>Lists applied patches.</td></tr><tr><td><code>--status</code></td><td>Return a status of an update. Refer to the exit code: <code>0</code> - host is updated to latest patch level, <code>1</code> - there are no applied patches, <code>2</code> - there are new not applied patches, <code>3</code> - kernel is unsupported</td></tr><tr><td><code>--force [since 2.3] </code></td><td>When used with update, forces applying the patch even if unable to freeze some threads.</td></tr><tr><td><code>--uname</code></td><td>Prints safe kernel version.</td></tr><tr><td><code>--license-info</code></td><td>Output current license info.</td></tr><tr><td><code>--register KEY</code></td><td>Register using KernelCare Enterprise Key.</td></tr><tr><td><code>--register-autoretry [since 2.5]</code></td><td>If registration fails retries registration indefinitely.</td></tr><tr><td><code>--unregister</code></td><td>Unregister from KernelCare Enterprise for Key based servers.</td></tr><tr><td><code>--userspace-update [PATCHES]</code></td><td>Download latest patches and apply them to the corresponding userspace processes. Ð¡an be set so that only certain types of patches are applied.</td></tr><tr><td><code>--test</code></td><td>Try test builds instead of production builds (deprecated, use --prefix=test instead).</td></tr><tr><td><code>--prefix</code></td><td>Patch source prefix, used to test different builds, by downloading builds from a different location, based on prefix (v2.2+)</td></tr><tr><td><code>--version</code></td><td>Print KernelCare Enterprise version.</td></tr><tr><td><code>--import-key PATH</code></td><td>Import gpg key.</td></tr><tr><td><code>--set-monitoring-key</code></td><td>Set monitoring key for IP based licenses. 16 to 32 characters, alphanumeric only [version 2.1+]</td></tr><tr><td><code>--freezer [since 2.3] </code></td><td>none: don&#39;t freeze any threads; full: freeze all threads; smart: freezes only threads that need to be frozen for patching. If option is not selected, best freezer method is chosen automatically.</td></tr><tr><td><code>--check [since 2.4-1]</code></td><td>Check if new patchset is available, without updating. Exit code 0 means there is a new kernel. 1 when there is no new kernel.</td></tr><tr><td><code>--doctor [since 2.6]</code></td><td>Send a report to the TuxCare support staff for diagnostics.</td></tr><tr><td><code>--set-patch-type extra </code></td><td>To enable extra patches.</td></tr><tr><td><code>--set-patch-type free</code></td><td>To enable free patches.</td></tr><tr><td><code>--set-sticky-patch SET_STICKY_PATCH</code></td><td>Set patch to stick to date in format DDMMYY or retrieve it from KEY if set to KEY (no support for ePortal). Empty to unstick. More info at <a aria-current="page" href="/live-patching-services/#sticky-patches" class="router-link-active router-link-exact-active">Sticky Patches</a>.</td></tr><tr><td><code>--tag COMMAND</code></td><td>Adds an extra <em>Tag</em> field for a server. COMMAND is a user-defined parameter.</td></tr></tbody></table><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Currenlty available userspace patch types are <code>libs</code> and <code>qemu</code>. To apply patches only for shared libraries, use <code>--userspace-update libs</code>.</p></div><h4 id="kcare-uname" tabindex="-1"><a class="header-anchor" href="#kcare-uname" aria-hidden="true">#</a> kcare-uname</h4><p>Print certain system information. With no OPTION, same as <code>-s</code>.</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><code>-a, --all</code></td><td>print all information in the following order, except omit <code>-p</code> and <code>-i</code> if unknown</td></tr><tr><td><code>-s, --kernel-name</code></td><td>print the kernel name</td></tr><tr><td><code>-n, --nodename</code></td><td>print the network node hostname</td></tr><tr><td><code>-r, --kernel-release</code></td><td>print the kernel release</td></tr><tr><td><code>-v, --kernel-version</code></td><td>print the kernel version</td></tr><tr><td><code>-m, --machine</code></td><td>print the machine hardware name</td></tr><tr><td><code>-p, --processor</code></td><td>print the processor type or <code>unknown</code></td></tr><tr><td><code>-i, --hardware-platform</code></td><td>print the hardware platform or <code>unknown</code></td></tr><tr><td><code>-o, --operating-system</code></td><td>print the operating system</td></tr><tr><td><code>--help</code></td><td>display this help and exit</td></tr><tr><td><code>--version</code></td><td>output version information and exit</td></tr></tbody></table><h4 id="kernelcare-doctor" tabindex="-1"><a class="header-anchor" href="#kernelcare-doctor" aria-hidden="true">#</a> kernelcare doctor</h4><p>This tool collects essential information about the KernelCare environment and sends it to the support team.</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># kcarectl --doctor
Generating report...
Uploading...
Key: FRWf74Zw11111111.83991334-1111-1111-1111-681ddd653e5f
Please, provide above mentioned key to KernelCare Support Team

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The command generates a report and prints out the ID which could be linked to a support ticket.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>If there was some connection problem during report uploading, the report will be stored locally as <code>/root/cl-report</code>. This file should be sent to the support team manually.</p></div><h3 id="config-options" tabindex="-1"><a class="header-anchor" href="#config-options" aria-hidden="true">#</a> Config options</h3><p>A <code>kcarectl</code> behavior can be configured using <code>/etc/sysconfig/kcare/kcare.conf</code></p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>`AUTO_UPDATE=YES</td><td>NO`</td></tr><tr><td><code>chkconfig kcare off</code></td><td>Disable auto-update after restart.</td></tr><tr><td>`PATCH_METHOD=normal</td><td>nofreeze</td></tr><tr><td><code>PATCH_SERVER</code></td><td>Server to use to download patches.</td></tr><tr><td><code>REGISTRATION_URL</code></td><td>Licensing server.</td></tr><tr><td><code>PREFIX=prefix</code></td><td>Patch source prefix, used to test different builds, by downloading builds from a different location, based on prefix (v2.2+)</td></tr><tr><td>`UPDATE_POLICY=REMOTE</td><td>LOCAL</td></tr><tr><td>`IGNORE_UNKNOWN_KERNEL=True</td><td>False<code></code>[since 2.5-4]`</td></tr><tr><td><code>LOAD_KCARE_SYSCTL [since 2.7-1]</code></td><td>Controls if <code>/etc/sysconfig/kcare/sysctl.conf</code> will be loaded on patchset load. True by default.</td></tr><tr><td><code>--set-patch-type extra</code></td><td>To enable extra patches.</td></tr><tr><td><code>--set-patch-type free</code></td><td>To enable free patches.</td></tr><tr><td><code>STICKY_PATCH=KEY</code></td><td>Retrieve sticky patch from <code>KEY</code> (see CLN, Key Edit); not supported for IP based servers or ePortal.</td></tr><tr><td><code>STICKY_PATCH=DDMMYY</code></td><td>Stick patch to a particular date. More info at <a aria-current="page" href="/live-patching-services/#sticky-patches" class="router-link-active router-link-exact-active">Sticky Patches</a>.</td></tr><tr><td>`REPORT_FQDN=True</td><td>False`</td></tr><tr><td><code>FORCE_GID=N</code></td><td>Use this group ID for symlink protection patch. By default, it&#39;s 48 (default Apache user GID) or 99 (<code>nobody</code> user)</td></tr><tr><td><code>USERSPACE_PATCHES=libs,qemu</code></td><td>Define which userspace patches will be applyed by default</td></tr></tbody></table><h3 id="disabling-some-patches" tabindex="-1"><a class="header-anchor" href="#disabling-some-patches" aria-hidden="true">#</a> Disabling some patches</h3><p>Some patches might affect the work of the system, and we created a way to disable them.</p><p>This is done via the <code>sysctl</code> command.</p><p>When new patchset loads, KernelCare Enterprise sysctl options get reset. To prevent that we added a file:</p><p><code>/etc/sysconfig/kcare/sysctl.conf</code></p><p>Options in this file will be loaded automatically on new patchset load.</p><p>To disable loading this options, specify:</p><p><code>LOAD_KCARE_SYSCTL=0</code> in <code>/etc/sysconfig/kcare/kcare.conf</code></p><p>To disable the patch, set the corresponding kcare option to <code>1</code>.</p><p>Patches that can be disabled:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Patch</td><td><em>sysctl</em> option</td></tr><tr><td>CVE-2015-5157</td><td>kcare_modify_ldt</td></tr></tbody></table><h1 id="extra-patchset" tabindex="-1"><a class="header-anchor" href="#extra-patchset" aria-hidden="true">#</a> Extra patchset</h1><div class="tip custom-block"><p class="custom-block-title">Note</p><p>KernelCare Enterprise 2.12-5 or higher</p></div><p>KernelCare Enterprise Extra patchset includes all the security fixes from KernelCare Enterprise for AlmaLinux, CentOS 6, CentOS 7, and CentOS 8 as well as symlink protection and IPSet bugfix for CentOS 6.</p><p>To enable extra patches and apply patch, run:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>kcarectl --set-patch-type extra --update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>To enable extra patches without update, run:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>kcarectl --set-patch-type extra
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>The â€˜extraâ€™ patch will be applied on the next automatic update.</p><p>To see details, run:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>kcarectl --patch-info
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>You should see something similar to:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>OS: centos6
kernel: kernel-2.6.32-696.6.3.el6
time: 2017-07-31 22:46:22
uname: 2.6.32-696.6.3.el6
 
kpatch-name: 2.6.32/symlink-protection.patch
kpatch-description: symlink protection // If you see this patch, it mean that you can enable symlink protection.
kpatch-kernel: kernel-2.6.32-279.2.1.el6
kpatch-cve: N/A
kpatch-cvss: N/A
kpatch-cve-url: N/A
kpatch-patch-url: https://gerrit.cloudlinux.com/#/c/16508/
 
kpatch-name: 2.6.32/symlink-protection.kpatch-1.patch
kpatch-description: symlink protection (kpatch adaptation)
kpatch-kernel: kernel-2.6.32-279.2.1.el6
kpatch-cve: N/A
kpatch-cvss: N/A
kpatch-cve-url: N/A
kpatch-patch-url: https://gerrit.cloudlinux.com/#/c/16508/
 
kpatch-name: 2.6.32/ipset-fix-list-shrinking.patch
kpatch-description: fix ipset list shrinking for no reason
kpatch-kernel: N/A
kpatch-cve: N/A
kpatch-cvss: N/A
kpatch-cve-url: N/A
kpatch-patch-url: https://bugs.centos.org/view.php?id=13499
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>To enable Symlink Owner Match Protection, add the following line:</p><p><code>fs.enforce_symlinksifowner=1</code></p><p>to <code>/etc/sysconfig/kcare/sysctl.conf</code>.</p><p>And run:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>sysctl -w fs.enforce_symlinksifowner=1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="sticky-patches" tabindex="-1"><a class="header-anchor" href="#sticky-patches" aria-hidden="true">#</a> Sticky patches</h3><div class="tip custom-block"><p class="custom-block-title">Note</p><p>This functionality is not available for ePortal customers. If you are using ePortal, please use <a href="/eportal/#feed-management" class="">Feeds</a> instead.</p></div><p>Sometimes you don&#39;t want to use the latest patches, but you&#39;d like to control which patches are get installed instead. For example, you have tested the patch released on 25th of May 2018 and want to use that patch across all servers.</p><p>You can do it by setting <code>STICKY_PATCH=250518</code> (ddmmyy format) in <code>/etc/sysconfig/kcare/kcare.conf</code> This guarantees that when <code>kcarectl --update</code> or <code>kcarectl --auto-update</code> is called, you will get patches from that date and not the newest patches.</p><p>With <code>STICKY_PATCH</code> you can go back as far as 60 days.</p><p>Alternatively, you can set <code>STICKY_PATCH=KEY</code> This way you can control the date from which patches will be applied using KernelCare keys in CLN. On update, the actual date will be retrieved from CLN (from Key settings) for the key used to register a particular server (not supported for IP based servers).</p><p>This is very useful if you want to test patches in QA first and later roll them out to production without doing any changes on the systems.</p><p>Here is how you can do that:</p><ul><li>Set <code>STICKY_PATCH=KEY</code> on all your servers.</li><li>Register QA servers with one KEY, and Production servers with ANOTHER key.</li><li>Then, stop new updates for Production servers. In CLN set <code>Sticky Tag</code> to <code>yesterday</code>. You can do it by editing KEY in CLN in DDMMYY format.</li><li>Now, for example, let&#39;s use patches as of 03052018 (DDMMYY format). Set them for your QA server key. On the next auto-update, your QA servers will get those patches (auto-updates are typically every 4 hours).</li></ul><p>Once you are happy with this patches, set the same Sticky Tag for Production servers key. In 4 hours your production servers should be updated to the same patches that QA servers were.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>You can choose any date within the last 60 days. You cannot choose today&#39;s date or date in the future.</p></div><h4 id="how-to-find-a-proper-sticky-patch-name" tabindex="-1"><a class="header-anchor" href="#how-to-find-a-proper-sticky-patch-name" aria-hidden="true">#</a> How to find a proper sticky patch name</h4><p>Let&#39;s assume that you have some kernel patch that you want to &quot;stick&quot; with. All you need is to find a proper label for that patch.</p><p><img src="/images/sticky-proper-label.png" alt="sticky-proper-label"></p><p>As you can see, the patch was released at 2020-09-16. And if apply label&#39;s date format, it becomes <code>16092020</code> that will be the sticky patch value.</p><h3 id="scanning-for-vulnerabilities" tabindex="-1"><a class="header-anchor" href="#scanning-for-vulnerabilities" aria-hidden="true">#</a> Scanning for vulnerabilities</h3><p>Identifying the vulnerabilities that apply to your systems is an important task for IT and InfoSec teams, and at TuxCare we make it easy. KernelCare live patching is integrated natively with vulnerability scanners including Tenable Nessus, Qualys, Rapid7 and many others.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>A generic integration that works with any vulnerability scanner is available for environments that native integration may not be sufficient. Contact your account manager or <a href="mailto:sales@tuxcare.com">sales@tuxcare.com</a> for more information.</p></div><h4 id="how-to-use-a-vulnerability-scanner-with-kernelcare" tabindex="-1"><a class="header-anchor" href="#how-to-use-a-vulnerability-scanner-with-kernelcare" aria-hidden="true">#</a> How to use a vulnerability scanner with KernelCare</h4><p>Itâ€™s rather simple. New scan results after installing a package and applying a patchset should not show any kernel CVEs that are handled by KernelCare Enterprise.</p><p>For example, Nessus for an old kernel shows a bunch of detected CVEs:</p><p><img src="/images/scanner-manipulation-before.png" alt=""></p><p>After the live patches were applied, there are no kernel-related CVEs:</p><p><img src="/images/scanner-manipulation-after.png" alt=""></p><h4 id="how-use-openscap-with-kernelcare" tabindex="-1"><a class="header-anchor" href="#how-use-openscap-with-kernelcare" aria-hidden="true">#</a> How use OpenSCAP with KernelCare</h4><p>OpenSCAP is an open source vulnerability scanner and compliance tool and it can be used to scan a system protected by KernelCare Enterprise. The following commands show how to use OpenSCAP to produce a vulnerability report for a system.</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ source /etc/os-release
$ wget https://patches.kernelcare.com/oval/com.kernelcare.${ID}.${VERSION_ID}.xml
$ oscap oval eval --report report.htm com.kernelcare.${ID}.${VERSION_ID}.xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="how-to-natively-integrate-kernelcare-with-a-vulnerability-scanner" tabindex="-1"><a class="header-anchor" href="#how-to-natively-integrate-kernelcare-with-a-vulnerability-scanner" aria-hidden="true">#</a> How to natively integrate KernelCare with a vulnerability scanner</h4><div class="tip custom-block"><p class="custom-block-title">Note</p><p>These instructions are intended for integrators with 3rd party vulnerability scanners.</p></div><p>There are two ways for a vulnerability scanner to integrate with KernelCare live patching.</p><h4 id="integrate-via-oval-data" tabindex="-1"><a class="header-anchor" href="#integrate-via-oval-data" aria-hidden="true">#</a> Integrate via OVAL data</h4><p>KernelCare comes with OVAL data that provide the instructions to the scanner to identify the vulnerabilities that are addressed by the installed live patches. OVAL data are available for the operating systems supported by KernelCare Enterprise, including AlmaLinux, Red Hat Enterprise Linux, Oracle Linux, CentOS, Debian and Ubuntu.</p><p>The OVAL data cover all KernelCare enterprise products and add-ons including LibCare, and QEMUCare.</p><p>The OVAL data for KernelCare live patching are available at <a href="https://patches.kernelcare.com/oval/" target="_blank" rel="noopener noreferrer">patches.kernelcare.com/oval</a>.</p><h4 id="integrate-using-files" tabindex="-1"><a class="header-anchor" href="#integrate-using-files" aria-hidden="true">#</a> Integrate using files</h4><p>KernelCare provides two files that list the vulnerabilities that are addressed by the currently installed live patches. These files contain a list of CVEs separated by a newline.</p><p>The list of vulnerabilities addressed by Kernel live patches is available at:</p><ul><li><code>/proc/kcare/cvelist</code></li></ul><p>The list of vulnerabilities addressed by system live patching (LibCare, QEMUCare etc.) is available at:</p><ul><li><code>/var/cache/kcare/libcare_cvelist</code></li></ul><h3 id="uefi-secure-boot-support" tabindex="-1"><a class="header-anchor" href="#uefi-secure-boot-support" aria-hidden="true">#</a> UEFI Secure Boot Support</h3><div class="tip custom-block"><p class="custom-block-title">Note</p><p>This feature is an early stage of adoption. Not all the distribution will be able to support.</p></div><p>This new functionality lets KernelCare work on systems with secure boot set up in their UEFI firmware. We are going to add a public certificate to the MOK (Machine Owner Keys) database that KernelCare will use to sign modules.</p><p>The latest KernelCare package contains a public certificate and will be available in the <code>/usr/libexec/kcare/kernelcare_pub.der</code>. For older versions, it could be downloaded from the <a href="https://patches.kernelcare.com/kernelcare_pub.der" target="_blank" rel="noopener noreferrer">https://patches.kernelcare.com/kernelcare_pub.der</a> to that location.</p><p>For example:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>curl -o /usr/libexec/kcare/kernelcare_pub.der https://patches.kernelcare.com/kernelcare_pub.der

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>Use <code>mokutil</code> as root to add this new MOK to the UEFI firmware.</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ mokutil --import /usr/libexec/kcare/kernelcare_pub.der
 input password:
 input password again:
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>It doesn&#39;t have a MOK password, and <code>mokutil</code> will ask you to create one. The password is temporary and will be used on the next boot.</p><ol start="2"><li>Reboot your machine to enter the MOK manager EFI utility.</li></ol><p>First, go down to the &#39;Enroll Mok&#39;:</p><p><img src="/images/uefi-enroll-mok.png" alt="alt text" title="Select Enroll MOK"></p><p>Then the firmware gives you the option of viewing the new MOK or continuing. Let&#39;s continue.</p><p><img src="/images/uefi-continue.png" alt="alt text" title="Select Continue"></p><p>It then asks you to confirm the enrollment.</p><p><img src="/images/uefi-yes.png" alt="alt text" title="Select Yes"></p><p>Then you will need to enter the password you used when running <code>mokutil --import</code>.</p><p><img src="/images/uefi-password.png" alt="alt text" title="Enter the password"></p><p>Finally, the firmware will ask you to reboot.</p><p><img src="/images/uefi-ok.png" alt="alt text" title="Select OK"></p><ol start="3"><li>Verify the key has been loaded by finding it in the output of the following command:</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ mokutil --list-enrolled | egrep -i &#39;SHA1|Issuer&#39;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>In some cases the enrolled key will not be shown but could be verified by the following command:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ dmesg | grep -i &#39;cloud linux&#39; 
[   0.722149] EFI: Loaded cert &#39;Cloud Linux Software, Inc: Kernel Module Signing Key: 12ff0613c0f80cfba3b2f8eba71ebc27c5a76170&#39; linked to &#39;.system_keyring&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>That&#39;s it. Now you should be able to apply patches as usual.</p><p>To get more information about signing kernel modules for secure boot, see <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/managing_monitoring_and_updating_the_kernel/signing-kernel-modules-for-secure-boot_managing-monitoring-and-updating-the-kernel" target="_blank" rel="noopener noreferrer">https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/managing_monitoring_and_updating_the_kernel/signing-kernel-modules-for-secure-boot_managing-monitoring-and-updating-the-kernel</a>.</p><h3 id="live-patching-and-fips-compliance" tabindex="-1"><a class="header-anchor" href="#live-patching-and-fips-compliance" aria-hidden="true">#</a> Live patching and FIPS compliance</h3><p>The FIPS-140 certification of a Linux kernel validates that the cryptography contained within a Linux kernel complies with the US government FIPS-140 data protection standard. Meaning that algorithms like AES, the random generator and other cryptographic aspects of the kernel are implemented as the standard defines.</p><p>At the same time the certification is a lengthy process â€“a typical validation can take almost a yearâ€“ and for that reason only some of each vendorâ€™s kernels are validated. That is because vendors release new kernels with security and feature updates on a regular cadence some as often as weekly, irrespective of their FIPS validation status. This means users of FIPS validated kernels need to choose between: (a) strict compliance by staying on the same kernel without updating until the next validated kernel is available and (b) reducing their security risk by installing new kernels with security updates even if they are not validated. The same story applies to the vendorâ€™s live patching solutions.</p><p>With KernelCare Enterprise it is possible to live patch FIPS-140 validated Linux kernels, for example at the Red Hat Enterprise Linux operating system. The live patches applied to these kernels, in this example, consist of the same RHEL kernel patches but are limited to the ones addressing security vulnerabilities. That way, a live patched kernel contains the same security fixes as a vendor update without any feature or bug-fix updates, e.g., updates that may change the cryptographic subsystem for performance or other non-security related reasons.</p><p><strong>In this way, security-conscious users of FIPS-validated Linux kernels that today apply their vendor&#39;s security patches can rely on KernelCare live patching the same way they do with their vendor&#39;s security updates</strong>. Furthermore, KernelCare live patching applies the minimum possible updates to the validated kernel by explicitly excluding any non-security updates.</p><h3 id="firewall-and-proxy-settings" tabindex="-1"><a class="header-anchor" href="#firewall-and-proxy-settings" aria-hidden="true">#</a> Firewall and Proxy Settings</h3><h4 id="patching-servers-through-firewall" tabindex="-1"><a class="header-anchor" href="#patching-servers-through-firewall" aria-hidden="true">#</a> Patching servers through firewall</h4><p>As long as your servers have access to the Internet, even behind NAT â€” you will be able to use KernelCare patch server without any problems.</p><p>Generally, KernelCare requires connection to only two servers for a proper work:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>cln.cloudlinux.com
patches.kernelcare.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>An additional address is used for KernelCare agent installation/update:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>repo.cloudlinux.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/images/patchingthroughfirewall.png" alt=""></p><h4 id="patching-servers-through-proxy" tabindex="-1"><a class="header-anchor" href="#patching-servers-through-proxy" aria-hidden="true">#</a> Patching servers through proxy</h4><p>If your servers don&#39;t have direct Internet access but can gain access to the Internet using proxy, the configuration is not that different. KernelCare can pick up standard environment variables for a proxy.</p><p>Make sure you have environment settings for proxy setup, and everything else will be the same as if servers were directly connected to the Internet:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># export http_proxy=http://proxy.domain.com:port
# export https_proxy=http://proxy.domain.com:port
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Settings defined by <code>export</code> are case-insensitive, so the example above could be as follows:</p></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># export HTTP_PROXY=http://proxy.domain.com:port
# export HTTPS_PROXY=http://proxy.domain.com:port
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>You can define these settings in the KernelCare config <code>/etc/sysconfig/kcare/kcare.conf</code>.</p><p>Example:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ cat /etc/sysconfig/kcare/kcare.conf
AUTO_UPDATE=True
HTTPS_PROXY=http://myproxy.com:59794
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>If you define these settings in the config, you don&#39;t need to export them each <code>kcarectl</code> launch and don&#39;t need to edit cron jobs.</p><p>All <code>kcarectl</code> launches will be aware of proxy settings from the config. In this case, you need to set proxy settings only once.</p><p><img src="/images/patchingthroughproxy.png" alt=""></p><h3 id="kernelcare-on-aws-â€“-deployment-user-guide" tabindex="-1"><a class="header-anchor" href="#kernelcare-on-aws-â€“-deployment-user-guide" aria-hidden="true">#</a> KernelCare on AWS â€“ Deployment User Guide</h3><h4 id="introductory-material" tabindex="-1"><a class="header-anchor" href="#introductory-material" aria-hidden="true">#</a> Introductory Material</h4><h4 id="introduction-1" tabindex="-1"><a class="header-anchor" href="#introduction-1" aria-hidden="true">#</a> Introduction</h4><p>The Linux kernel is the most important piece of software on your server, as a security flaw in it can expose all of your services and customers&#39; data. KernelCare is a technology that allows you to keep the Linux kernel safe at all times, automatically, without ever having to stop the server and rebooting it causing downtime and inconvenient scheduling of maintenance windows. This improves availability, security, stability, operation costs, and customer satisfaction. It works with almost all mainstream distributions of Linux. It is simple, fast, and very easy to deploy while being able to handle very complex patches and customized kernels if you need them.</p><h4 id="prerequisites-and-requirements" tabindex="-1"><a class="header-anchor" href="#prerequisites-and-requirements" aria-hidden="true">#</a> Prerequisites and Requirements</h4><p>KernelCare can be installed on any x86_64 compatible server or VM running one of the following distribution:</p><ul><li>Amazon Linux 1, 2</li><li>CentOS 6, 7, Xen4CentOS, CentOS-Plus, ElRepo</li><li>CloudLinux 6, 7</li><li>Debian 7, 8, 9, 8-backports</li><li>Oracle Linux 6, 7</li><li>ProxmoxVE 3,4,5</li><li>RedHat EL 6, 7</li><li>Ubuntu 14.04, 16.04, 18.04</li><li>Virtuozzo 6</li></ul><p>The exact list of compatible kernels can be found on the following link: <a href="https://patches.kernelcare.com/" target="_blank" rel="noopener noreferrer">https://patches.kernelcare.com/</a>.</p><p>Standard OS kernels are required in most cases unless the custom kernel is supported.</p><p>The software can be installed on the running server and doesn&#39;t require a reboot.</p><p>Basic Linux skills are sufficient to deploy KernelCare on AWS. Simple deployments involve just an EC2 instance. KernelCare is available as BYOL model. You need to register in our <a href="https://cln.cloudlinux.com" target="_blank" rel="noopener noreferrer">customer portal</a> to get the trial license. Once you get the trial license, you need to register your running EC2 instance with the activation key.</p><h4 id="architecture-diagrams" tabindex="-1"><a class="header-anchor" href="#architecture-diagrams" aria-hidden="true">#</a> Architecture Diagrams</h4><p>As long as your servers have access to the Internet, even behind NAT â€“ you will be able to use KernelCare patch server without any problems.</p><p>Generally, KernelCare requires HTTPS connection to two servers for the proper work:</p><ul><li>cln.cloudlinux.com</li><li>patches.kernelcare.com</li></ul><p><img src="/images/AWS_arch2.png" alt=""></p><p>If your servers don&#39;t have direct Internet access but can gain access to the Internet using proxy, the configuration is not that different. KernelCare can pick up standard environment variables for proxy.</p><p><img src="/images/AWS_proxy_arch2.png" alt=""></p><p>Make sure you have environment settings for proxy setup, and everything else will be the same as if the servers were directly connected to the Internet:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># export http_proxy=http://proxy.domain.com:port
# export https_proxy=http://proxy.domain.com:port
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="planning-guidance" tabindex="-1"><a class="header-anchor" href="#planning-guidance" aria-hidden="true">#</a> Planning Guidance</h4><h4 id="security" tabindex="-1"><a class="header-anchor" href="#security" aria-hidden="true">#</a> Security</h4><p>The only thing you need to be able to install/control you KernelCare deployment is SSH access (root credentials, key-based authentication/sudo or similar mechanisms are preferred).</p><h4 id="costs" tabindex="-1"><a class="header-anchor" href="#costs" aria-hidden="true">#</a> Costs</h4><p>KernelCare is billed as a subscription service â€“ you can find more details in the table below.</p><table><thead><tr><th><strong>License Volume</strong></th><th><strong>Monthly Price</strong></th><th><strong>Annual Price</strong></th></tr></thead><tbody><tr><td>1</td><td>$3.95</td><td>$45</td></tr><tr><td>2-49</td><td>$2.95</td><td>$33</td></tr><tr><td>50-499</td><td>$2.55</td><td>$28</td></tr><tr><td>500+</td><td>$2.25</td><td>$25</td></tr></tbody></table><h4 id="sizing" tabindex="-1"><a class="header-anchor" href="#sizing" aria-hidden="true">#</a> Sizing</h4><p>KernelCare agent has a tiny RAM footprint â€“ binary patches usually require less than 1 MB.</p><h4 id="deployment-guidance" tabindex="-1"><a class="header-anchor" href="#deployment-guidance" aria-hidden="true">#</a> Deployment Guidance</h4><h4 id="deployment-assets" tabindex="-1"><a class="header-anchor" href="#deployment-assets" aria-hidden="true">#</a> Deployment Assets</h4><p>To install KernelCare, run:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>curl -s -L https://kernelcare.com/installer | bash
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>or:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>wget -qq -O - https://kernelcare.com/installer | bash
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>If you are using IP-based license, nothing else required to be done. If you are using key-based license, run:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ /usr/bin/kcarectl --register KEY
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>KEY</code> is the registration key code string provided when you sign up for purchase or trial of the product.</p><p>You can easily automate KernelCare deployment with Ansible, Puppet, Chef or other automation tools. Here are the steps that may be automated:</p><ol><li>Distribute KernelCare agent package (optional â€“ required only for servers with no access to the Internet) and a KernelCare agent configuration file (<code>/etc/sysconfig/kcare/kcare.conf</code>).</li><li>Set required environmental variables (optional).</li><li>Install KernelCare agent from either locally available package or central KernelCare download location.</li><li>Register KernelCare with either license key or IP-based license.</li></ol><h4 id="operational-guidance" tabindex="-1"><a class="header-anchor" href="#operational-guidance" aria-hidden="true">#</a> Operational Guidance</h4><h4 id="health-check" tabindex="-1"><a class="header-anchor" href="#health-check" aria-hidden="true">#</a> Health Check</h4><p>Systems protected by KernelCare can be monitored by means of CloudLinux Network (CLN) portal available at <a href="https://cln.cloudlinux.com" target="_blank" rel="noopener noreferrer">https://cln.cloudlinux.com</a>. Registered KernelCare installations are grouped by license keys. Kernels that are marked with exclamation sign in <span style="color:#E76930;">amber</span> do not have the latest patches installed.</p><p><img src="/images/KC-Ent-monit.png" alt=""></p><p>In either case, you can check whether the latest available patch has been applied by running the following command on a system protected by KernelCare:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ /usr/bin/kcarectl --check
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="backup-and-recovery" tabindex="-1"><a class="header-anchor" href="#backup-and-recovery" aria-hidden="true">#</a> Backup and Recovery</h4><p>There is no reason to backup KernelCare. KernelCare doesn&#39;t store any data. You can always re-install and re-register KernelCare. To backup the configuration file of KernelCare if you have modified it, backup the <code>/etc/sysconfig/kcare/</code> folder.</p><h4 id="routine-maintenance" tabindex="-1"><a class="header-anchor" href="#routine-maintenance" aria-hidden="true">#</a> Routine Maintenance</h4><p>KernelCare is packaged in RPM/DEB packages (depending on Linux distribution) and will update any time system packages are updated. No additional maintenance is needed.</p><h4 id="emergency-maintenance" tabindex="-1"><a class="header-anchor" href="#emergency-maintenance" aria-hidden="true">#</a> Emergency Maintenance</h4><p>If one of your instances degraded, once you start another instance based on EBS or snapshot â€“ KernelCare will continue working as before, no additional work is needed. If you set up a new server instead, re-register KernelCare on the new server. If you decide to uninstall patches, run command:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># kcarectl --unload
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>or complete remove <em>kernelcare</em> package by running the following command:</p><ul><li>on RPM-based systems<div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># rpm -e kernelcare
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul><p>or</p><ul><li>on DEB-based systems<div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># dpkg --remove kernelcare
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul><h4 id="patch-feed-advanced-options" tabindex="-1"><a class="header-anchor" href="#patch-feed-advanced-options" aria-hidden="true">#</a> Patch Feed Advanced Options</h4><h5 id="test-and-delayed-feeds" tabindex="-1"><a class="header-anchor" href="#test-and-delayed-feeds" aria-hidden="true">#</a> <strong>Test and Delayed Feeds</strong></h5><p>KernelCare Patch Server has several patch feeds available in addition to the standard (production) feed:</p><ul><li><strong>Test feed</strong> â€“ the newest patches (test builds) that have not undergone the complete testing process. Test feed makes it possible to start testing new patches earlier.</li><li><strong>Delayed feeds</strong> â€“ instructs KernelCare to skip loading patches that were released within the last 12/24/48 hours.</li></ul><p>The alternate feed option is enabled by setting <code>PREFIX</code> variable in <code>/etc/sysconfig/kcare/kcare.conf</code> to one of <code>test</code>/<code>12h</code>/<code>24h</code>/<code>48h</code>.</p><h5 id="feed-management-with-sticky-patch-feature" tabindex="-1"><a class="header-anchor" href="#feed-management-with-sticky-patch-feature" aria-hidden="true">#</a> <strong>Feed Management With Sticky Patch Feature</strong></h5><p>The best way to handle QA and Production environments is to use Sticky tag feature of KernelCare license keys issued from CloudLinux Network (CLN) portal. To use this tag, go to CLN portal â†’ KernelCare tab â†’ click on the target key â†’ Edit Key Info window.</p><p><img src="/images/KC-Ent-list.png" alt=""></p><p><img src="/images/KC-Ent-edit.png" alt=""></p><p>You should provide a separate key for each environment and set them to a particular sticky tag which is actually the date to which all the servers in an environment have to be patched.</p><p><img src="/images/KC-Ent-sticky.png" alt=""></p><p>The date in Sticky tag field can be any date from May 28, 2018 up to one day before today.</p><p>To use Sticky tag feature on the servers to be patched, run:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ /usr/bin/kcarectl --set-sticky-patch=KEY
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Alternatively, you can do the same by adding <code>STICKY_PATCH=KEY</code> to the <code>/etc/sysconfig/kcare/kcare.conf</code> file.</p><div class="tip custom-block"><p class="custom-block-title">Warning</p><p><strong>Do Not</strong> replace the <code>KEY</code> word with the actual KernelCare license key used to register the server.</p></div><p>When the Sticky tag feature is enabled for particular servers, all such servers will get patches only released before the date specified in the Sticky tag field.</p><p>This way, you can add new patches to all the servers in some environment (i.e. registered with the same KernelCare license key) by updating only a single field in the CLN portal.</p><h4 id="support" tabindex="-1"><a class="header-anchor" href="#support" aria-hidden="true">#</a> Support</h4><p>We offer unlimited, 24x7x365 support. <a href="https://cloudlinux.zendesk.com/hc/requests/new" target="_blank" rel="noopener noreferrer">Submit a request</a> or email us at <a href="mailto:support@cloudlinux.com">support@cloudlinux.com</a>.</p><ul><li>We answer all support questions within one business day and most within a couple of hours To expedite the support, run the following command on your server (as root user):</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># kcarectl --doctor
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Then paste the generated key into the support request.</p><h4 id="support-costs" tabindex="-1"><a class="header-anchor" href="#support-costs" aria-hidden="true">#</a> Support Costs</h4><p>Your KernelCare subscription includes free 24/7 support.</p><h4 id="accessibility" tabindex="-1"><a class="header-anchor" href="#accessibility" aria-hidden="true">#</a> Accessibility</h4><h4 id="reference-materials" tabindex="-1"><a class="header-anchor" href="#reference-materials" aria-hidden="true">#</a> Reference Materials</h4><ul><li>KernelCare website: <a href="https://www.kernelcare.com" target="_blank" rel="noopener noreferrer">https://www.kernelcare.com</a></li><li>KernelCare Blog: <a href="https://www.kernelcare.com/blog/" target="_blank" rel="noopener noreferrer">https://www.kernelcare.com/blog/</a></li><li>KernelCare Patch Server: <a href="https://patches.kernelcare.com" target="_blank" rel="noopener noreferrer">https://patches.kernelcare.com</a></li><li>KernelCare documentation: <a href="https://docs.kernelcare.com/" target="_blank" rel="noopener noreferrer">https://docs.kernelcare.com/</a></li><li>CloudLinux Network â€“ CLN (Billing Portal): <a href="https://cln.cloudlinux.com" target="_blank" rel="noopener noreferrer">https://cln.cloudlinux.com</a></li><li>CloudLinux 24/7 online support system: <a href="https://tuxcare.zendesk.com" target="_blank" rel="noopener noreferrer">https://tuxcare.zendesk.com</a></li></ul><h4 id="localization" tabindex="-1"><a class="header-anchor" href="#localization" aria-hidden="true">#</a> Localization</h4><p>KernelCare is available in the English language only.</p><h3 id="reseller-partner-ui" tabindex="-1"><a class="header-anchor" href="#reseller-partner-ui" aria-hidden="true">#</a> Reseller Partner UI</h3><p>Once you have got the reseller partner access, in IP Reseller Partner UI you can view and manage IP licenses, billing options, profile details. Here you can track your money balance, licenses count and licenses prices as well as using IP address search to find customers. You can find more information about KernelCare licensing <a href="https://www.kernelcare.com/pricing/" target="_blank" rel="noopener noreferrer">here</a>.</p><h4 id="server-section" tabindex="-1"><a class="header-anchor" href="#server-section" aria-hidden="true">#</a> Server Section</h4><p>As soon as you have added funds (See <strong>Billing Info/Add Funds</strong> below) to your account you can immediately add new licenses for clients. To add IP KernelCare license:</p><ol><li>Enter IP address in <strong>Add IP License</strong> field, choose license type in pull-down menu (KernelCare) and click <strong>Add license</strong>.</li></ol><p><img src="/images/reseller001.jpg" alt=""></p><ol start="2"><li><p>To delete license click <strong>Delete</strong> in front of the needed IP address.</p></li><li><p>To add KernelCare Key license go to <strong>KernelCare Keys</strong> tab, enter the number of servers allowed for the license in <strong>Max Servers</strong>, add description if needed and click <strong>Add</strong> . The key will be generated and appear in the list below.</p></li></ol><p>In the <strong>Operations List</strong> you are able to edit or delete the key.</p><p><img src="/images/reseller007_zoom96.png" alt=""></p><h4 id="billing-info-add-funds" tabindex="-1"><a class="header-anchor" href="#billing-info-add-funds" aria-hidden="true">#</a> Billing Info/Add Funds</h4><p>To add funds:</p><ol><li><p>Click <strong>Add Funds</strong> near your balance or go to <strong>Billing Info/Add Funds</strong> on the top of the starting page of your account.</p></li><li><p>Click <strong>Add</strong> to add credit card details, then enter funds amount and click <strong>TopUp</strong> or <strong>Process to Checkout</strong> to pay via PayPal.</p></li></ol><p><img src="/images/reseller002.jpg" alt=""></p><p>While adding credit card details, you can also choose <strong>Auto add funds</strong> option - the funds amount you choose in pull down menu will be automatically added when your balance is below $100.</p><p>If you choose <strong>Auto repay</strong>, your card will be automatically charged when your balance becomes negative. Minimal charge is $20 (E.g. for balance -$15 - you&#39;ll be charged at $20, for balance -$134.2 - you&#39;ll be charged at $134.2).</p><p><img src="/images/reseller003.jpg" alt=""></p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>If your balance is shown as negative, it means that you have to deposit more funds.</p></div><h4 id="api-section" tabindex="-1"><a class="header-anchor" href="#api-section" aria-hidden="true">#</a> API Section</h4><p>CloudLinux and KernelCare IP licenses adding and removing is compatible with different hosting and domain management and billing systems and platforms. You can find comprehensive information on all possible CloudLinux modules and plug-ins APIs in API Section.</p><p><img src="/images/reseller004.jpg" alt=""></p><h4 id="profile" tabindex="-1"><a class="header-anchor" href="#profile" aria-hidden="true">#</a> Profile</h4><p>You can edit your profile information by clicking on <strong>Profile</strong> section. Edit the necessary info and click <strong>Update Account</strong>.</p><p><img src="/images/reseller5.jpg" alt=""><img src="/images/reseller006.jpg" alt=""></p><h3 id="how-to" tabindex="-1"><a class="header-anchor" href="#how-to" aria-hidden="true">#</a> How To</h3><h4 id="how-to-disable-hyperthreading-smt-without-reboot-kernelcare-case" tabindex="-1"><a class="header-anchor" href="#how-to-disable-hyperthreading-smt-without-reboot-kernelcare-case" aria-hidden="true">#</a> How to disable HyperThreading (SMT) without reboot: KernelCare case</h4><p>This article explains how to disable or enable SMT (Simultaneous multithreading) without rebooting using KernelCare, to help mitigate the recent MDS/Zombieload vulnerability.</p><p>Disabling CPU simultaneous multithreading (SMT) is one of the mitigations needed to counter the recent MDS vulnerability (also known as â€˜Zombieloadâ€™). There is a performance impact that depends on the configuration of the hosting platform and its workload patterns. You should also consider the impact of other mitigation strategies, such as assigning dedicated cores to guests (e.g. VMs).</p><p>You can control and get the status of SMT with the kernelâ€™s <code>sysfs</code> interface. There are two files, both in the <code>/sys/devices/system/cpu/smt</code> directory:</p><ul><li><code>control</code></li><li><code>active</code></li></ul><p>If you cannot find the <code>/sys/devices/system/cpu/smt</code> directory, this means your running kernel does not support SMT. In this case, you need to apply KernelCare patches so the SMT controls become available to your system. Use the <code>kcarectrl</code> command:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>kcarectl --update
Kernel is safe
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ls -l /sys/devices/system/cpu/smt
-r--r--r-- 1 root root 4096 May 17 13:06 active
-rw-r--r-- 1 root root 4096 May 17 13:06 control
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>As soon as you have these files in place, it is possible to proceed with disabling SMT.</p><iframe width="560" height="315" src="https://www.youtube.com/embed/RUGCvEO1hAE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><h4 id="smt-control" tabindex="-1"><a class="header-anchor" href="#smt-control" aria-hidden="true">#</a> SMT Control</h4><p><code>/sys/devices/system/cpu/smt/control</code></p><p>This file lets you enable or disable SMT, and shows its state. There are three values:</p><ol><li><code>on</code>: The CPU supports SMT and it is enabled. All logical CPUs can be taken offline or online without restriction.</li><li><code>off</code>: The CPU supports SMT but it is disabled. Only so-called primary SMT threads can be taken offline/online without restriction. Attempts to put a non-primary sibling thread online will be rejected.</li><li><code>notsupported</code>: The CPU does not support SMT. You will not be able to write to the control file.</li></ol><h4 id="smt-status" tabindex="-1"><a class="header-anchor" href="#smt-status" aria-hidden="true">#</a> SMT Status</h4><p><code>/sys/devices/system/cpu/smt/active</code></p><p>The contents of this file show the status of SMT (e.g. if two or more sibling threads are active on the same physical core the contents of this file is 1, if not: 0).</p><p>Here are some commands to control SMT support (root permissions are required):</p><h4 id="check-the-smt-state" tabindex="-1"><a class="header-anchor" href="#check-the-smt-state" aria-hidden="true">#</a> Check the SMT state</h4><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>cat /sys/devices/system/cpu/smt/active
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="enable-smt" tabindex="-1"><a class="header-anchor" href="#enable-smt" aria-hidden="true">#</a> Enable SMT</h4><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>echo on &gt; /sys/devices/system/cpu/smt/control
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="disable-smt" tabindex="-1"><a class="header-anchor" href="#disable-smt" aria-hidden="true">#</a> Disable SMT</h4><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>echo off &gt; /sys/devices/system/cpu/smt/control
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Disabling SMT, <a href="/how-to/#how-to-update-microcode-without-reboot-with-vendor-provided-package" class="">updating microcode</a>, and applying KernelCare patches will protect your systems against the ZombieLoad vulnerability. Note, only the latter action is applicable to virtual systems (e.g. VMs, VPS and other cloud instance types).</p><h4 id="how-to-update-microcode-without-reboot-with-vendor-provided-package" tabindex="-1"><a class="header-anchor" href="#how-to-update-microcode-without-reboot-with-vendor-provided-package" aria-hidden="true">#</a> How to update Microcode without reboot with vendor-provided package</h4><p>This article shows how to update the microcode of Intel CPUs running Linux.</p><div class="warning custom-block"><p class="custom-block-title">Warning</p><p>To avoid possible issues with Microcode updating, enable SMT before the update.</p></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>This article is subject to change and will be updated with instructions for other distributions.</p></div><div class="tip custom-block"><p class="custom-block-title">Notes</p><ul><li>These steps must be done as root.</li><li>The examples shown are for Debian.</li><li>If you have doubts your systems are fully protected against CPU- and kernel-related vulnerabilities, please <a href="mailto:sales@cloudlinux.com">get in touch with us</a>.</li></ul></div><h4 id="updating-microcode-on-ubuntu-and-debian" tabindex="-1"><a class="header-anchor" href="#updating-microcode-on-ubuntu-and-debian" aria-hidden="true">#</a> Updating microcode on Ubuntu and Debian</h4><ol><li><p>Find the microcode package download link for your platform</p><ul><li>Ubuntu: <a href="https://usn.ubuntu.com/3977-1/" target="_blank" rel="noopener noreferrer">https://usn.ubuntu.com/3977-1/</a></li><li>Debian: <a href="https://packages.debian.org/search?keywords=intel-microcode" target="_blank" rel="noopener noreferrer">https://packages.debian.org/search?keywords=intel-microcode</a></li></ul></li><li><p>Download the package</p></li></ol><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Example shown for Debian 9</p></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>cd &lt;a temporary directory, e.g. /tmp&gt;
mkdir firmware
cd firmware
wget http://security.debian.org/debian-security/pool/updates/non-free/i/intel-microcode/intel-microcode_3.20190514.1~deb9u1_amd64.deb
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>Check the downloaded package</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>md5sum intel-microcode_3.20190514.1~deb9u1_amd64.deb
c7bc9728634137453e0f4821fb6bb436  intel-microcode_3.20190514.1~deb9u1_amd64.deb
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>A list of checksums is on <a href="https://packages.debian.org/stretch/amd64/intel-microcode/download" target="_blank" rel="noopener noreferrer">the Debian packages download page</a>.</p><ol start="4"><li>Unpack the package</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>dpkg -x intel-microcode_3.20190514.1~deb9u1_amd64.deb
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="5"><li>Check the unpacked files</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ls -l
total 1896
drwxr-xr-x 5 root root   53 May 15 04:18 etc
-rw-r--r-- 1 root root 1940140 May 17 11:42 intel-microcode_3.20190514.1~deb9u1_amd64.deb
drwxr-xr-x 3 root root   22 May 15 04:18 lib
drwxr-xr-x 3 root root   19 May 15 04:18 usr
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="6"><li>Create a backup of existing microcode:</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>test -d /lib/firmware/intel-ucode/ &amp;&amp; mv /lib/firmware/intel-ucode/ /lib/firmware/intel-ucode.backup
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="7"><li>Copy the new microcode and check it</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>cp -r lib/firmware/intel-ucode/ /lib/firmware/
ls -l /lib/firmware/ | grep intel-ucode
drwxr-xr-x  2 root root 4096 May 17 11:47 intel-ucode
drwxr-xr-x  2 root root 4096 May 16 20:54 intel-ucode.backup
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="8"><li>Check the current microcode version</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>dmesg | grep microcode
[ 2.254717] microcode: sig=0x306a9, pf=0x10, revision=0x12
[ 2.254820] microcode: Microcode Update Driver: v2.01 &lt;tigran@aivazian.fsnet.co.uk&gt;, Peter Oruba
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="9"><li>(Optional) Double check the current microcode versions (revisions per core)</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>cat /proc/cpuinfo | grep -e microcode
microcode : 0x12
microcode : 0x12
microcode : 0x12
microcode : 0x12
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="10"><li>Check the microcode reload file exists</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ls -l /sys/devices/system/cpu/microcode/reload
--w------- 1 root root 4096 May 17 11:54 /sys/devices/system/cpu/microcode/reload
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="11"><li>Force the kernel to load the new microcode</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>echo 1 &gt; /sys/devices/system/cpu/microcode/reload
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="12"><li>Check the new microcode</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>dmesg | grep microcode
[ 2.254717] microcode: sig=0x306a9, pf=0x10, revision=0x12
[ 2.254820] microcode: Microcode Update Driver: v2.01 &lt;tigran@aivazian.fsnet.co.uk&gt;, Peter Oruba
[ 1483.494573] platform microcode: firmware: direct-loading firmware intel-ucode/06-3a-09
[ 1483.495985] microcode: updated to revision 0x21, date = 2019-02-13
[ 1483.496012] platform microcode: firmware: direct-loading firmware intel-ucode/06-3a-09
[ 1483.496698] platform microcode: firmware: direct-loading firmware intel-ucode/06-3a-09
[ 1483.497391] platform microcode: firmware: direct-loading firmware intel-ucode/06-3a-09
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="13"><li>(Optional) Double check the new microcode version (revisions per core)</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>cat /proc/cpuinfo | grep -e microcode
microcode : 0x21
microcode : 0x21
microcode : 0x21
microcode : 0x21
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="updating-microcode-on-red-hat-and-centos" tabindex="-1"><a class="header-anchor" href="#updating-microcode-on-red-hat-and-centos" aria-hidden="true">#</a> Updating Microcode on Red Hat and CentOS</h4><p>For RHEL-based distributions, you can use the <code>microcode_ctl utility</code> to update microcode.</p><ol><li>Get the latest microcode by updating the <code>microcode_ctl</code> package</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>yum update microcode_ctl
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="2"><li>Create a force file</li></ol><p>Create a <code>force-late-intelâ€“06â€“4fâ€“01</code> inside the firmware directory.</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>touch /lib/firmware/`uname -r`/force-late-intel-06-4f-01
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="3"><li>Run the microcode update</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>/usr/libexec/microcode_ctl/update_ucode
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="4"><li>Force the kernel to load the new microcode</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>echo 1 &gt; /sys/devices/system/cpu/microcode/reload
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="5"><li>Check the new microcode</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>dmesg | grep microcode
[ 2.254717] microcode: sig=0x306a9, pf=0x10, revision=0x12
[ 2.254820] microcode: Microcode Update Driver: v2.01 &lt;tigran@aivazian.fsnet.co.uk&gt;, Peter Oruba
[ 1483.494573] platform microcode: firmware: direct-loading firmware intel-ucode/06-3a-09
[ 1483.495985] microcode: updated to revision 0x21, date = 2019-02-13
[ 1483.496012] platform microcode: firmware: direct-loading firmware intel-ucode/06-3a-09
[ 1483.496698] platform microcode: firmware: direct-loading firmware intel-ucode/06-3a-09
[ 1483.497391] platform microcode: firmware: direct-loading firmware intel-ucode/06-3a-09
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="6"><li>(Optional) Double check the new microcode version (revisions per core)</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>cat /proc/cpuinfo | grep -e microcode
microcode : 0x21
microcode : 0x21
microcode : 0x21
microcode : 0x21
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="updating-microcode-on-centos-6" tabindex="-1"><a class="header-anchor" href="#updating-microcode-on-centos-6" aria-hidden="true">#</a> Updating Microcode on CentOS 6</h4><ol><li>Get the latest microcode by updating the <code>microcode_ctl</code> package</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>yum update microcode_ctl
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="2"><li>If <code>yum update microcode_ctl</code> outputs the following:</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Package(s) microcode_ctl available, but not installed.
No Packages marked for Update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>you need to install the package manually.</p><ol start="3"><li>To install <code>microcode_ctl</code> package, run the command:</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>yum install microcode_ctl
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>The command output:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Installed:
  microcode_ctl.x86_64 2:1.17-33.11.el6_10                                                                                                                                 

Complete!
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>Check CPU microcode version:</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>cat /proc/cpuinfo | grep microcode
microcode       : 9
microcode       : 9
microcode       : 9
microcode       : 9
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li>Try to update microcode</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>microcode_ctl -u
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>If you see the output:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>microcode_ctl: writing microcode (length: 2370560)
microcode_ctl: cannot open /dev/cpu/microcode for writing errno=2 (No such file or directory)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>You need to load driver microcode.</p><ol start="6"><li>Load driver microcode</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>modprobe microcode
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="7"><li>Try to update microcode again:</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>microcode_ctl -u
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>If you see the output:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>microcode_ctl: writing microcode (length: 2370560)
microcode_ctl: microcode successfully written to /dev/cpu/microcode
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>then update is successful.</p><ol start="8"><li>Check version:</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>cat /proc/cpuinfo | grep microcode
microcode       : 17
microcode       : 17
microcode       : 17
microcode       : 17
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><iframe width="560" height="315" src="https://www.youtube.com/embed/EydWy-b9uns" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><h4 id="plesk-related" tabindex="-1"><a class="header-anchor" href="#plesk-related" aria-hidden="true">#</a> Plesk related</h4><h4 id="how-to-get-a-kernelcare-activation-key-from-the-extended-plesk-license" tabindex="-1"><a class="header-anchor" href="#how-to-get-a-kernelcare-activation-key-from-the-extended-plesk-license" aria-hidden="true">#</a> How to get a KernelCare activation key from the extended Plesk license</h4><p>Often our clients purchase KernelCare licenses through Plesk/Odin and in such cases, they get a universal key which includes the KernelCare license and other additional keys for Plesk plugins. Such a key has the following syntax â€“ <code>A00B00-0CDE00-F0G000-HIGK00-LM0N00</code>, â€“ and initially, it is installed through Plesk automatically and the license gets activated successfully.</p><p>However, if it is required to re-register the agent for some reason or simply get the KernelCare activation key separately, it would be impossible to apply the above-mentioned one â€“ we would need to deal with the KernelCare service separately.</p><p>To get the KernelCare activation key from the extended Plesk license key, you will need to proceed with the following.</p><ol><li>Navigate to <em>Tools &amp; Settings &gt;&gt; Plesk &gt;&gt; License Management &gt;&gt; Additional License Keys</em></li></ol><p><img src="/images/LicenseManagement.png" alt=""></p><p><img src="/images/AdditionalLicenseKeys.png" alt=""></p><ol start="2"><li><p>Click <em>Download key</em> next to the KernelCare license listed on the page and open the file downloaded in some text editor</p></li><li><p>Find the following abstract:</p></li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&lt;!--Key body--&gt;
&lt;aps-3:key-body core:encoding=&quot;base64&quot; core:type=&quot;binary&quot;&gt;YOUR_BASE64_ENCODED_LICENSE_KEY==&lt;/aps-3:key-body&gt;
&lt;!--Information about additional key--&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li><p>This is your base64-encoded key, and it should be decoded using a CLI utility or an online base64 decoder into UTF-8, e.g. <a href="https://www.base64decode.org" target="_blank" rel="noopener noreferrer">https://www.base64decode.org</a>. The new license key should have the following format: <code>xxxxxxxxxxxxxxxx</code>. It will contain lower and upper case letters and numbers.</p></li><li><p>Use the new key decoded to activate the service:</p></li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>/usr/bin/kcarectl --register DECODED_KEY_HERE
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>This is it!</p><h2 id="libcare" tabindex="-1"><a class="header-anchor" href="#libcare" aria-hidden="true">#</a> LibCare</h2><p>LibCare enables security patching of critical userspace shared libraries in-memory without restarting or disrupting the applications using them. This is techinical documentation describing the solution; for a high level summary see <a href="https://tuxcare.com/enterprise-live-patching-services/libcare/" target="_blank" rel="noopener noreferrer">LibCare&#39;s main web site</a>.</p><h3 id="supported-libraries-and-operating-systems" tabindex="-1"><a class="header-anchor" href="#supported-libraries-and-operating-systems" aria-hidden="true">#</a> Supported libraries and operating systems</h3><p>LibCare provide security updates for the OpenSSL and glibc libraries on many operating systems.</p><h3 id="supported-operating-systems" tabindex="-1"><a class="header-anchor" href="#supported-operating-systems" aria-hidden="true">#</a> Supported operating systems</h3><p>LibCare patching is available for many operating systems including CentOS, AlmaLinux, Oracle Linux, Debian and Ubuntu.</p><p><a href="https://patches.kernelcare.com/" target="_blank" rel="noopener noreferrer">Check compatibility with your operating system</a>.</p><h3 id="installation-and-upgrade" tabindex="-1"><a class="header-anchor" href="#installation-and-upgrade" aria-hidden="true">#</a> Installation and upgrade</h3><p>Userspace processes patching feature is available in the KernelCare package.</p><h3 id="usage" tabindex="-1"><a class="header-anchor" href="#usage" aria-hidden="true">#</a> Usage</h3><p>To apply the available patches to all userspace processes, run the following command:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ kcarectl --lib-update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>To gather information about what processes were patched, run the following command:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ kcarectl --lib-info
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>To gather information about applied patches, run the following command:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ kcarectl --lib-patch-info
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>To unpatch all processes, run the following command:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ kcarectl --lib-unload
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="blacklisting" tabindex="-1"><a class="header-anchor" href="#blacklisting" aria-hidden="true">#</a> Blacklisting</h4><p>Applying a live patch may clash with software such as anti-viruses that detect or prevent memory updates. While the majority of software is compatible with live patching, for the software that may misbehave, LibCare comes with a default blacklist. The blacklist is located in the /var/lib/libcare/blacklist and contains the list of known applications that may misbehave when live patched. You can override those values by creating the file <code>/var/cache/kcare/userspace/blacklist</code>.</p><p>The format of the file is as follows. Patterns should be specified line by line prefixed with pattern type and a colon. Comment starts with dash (#). Example:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code> # Symantec Antivirus
 path: /opt/Symantec/*
 filename:symcfgd
 filename:rtvscand
 filename:smcd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Specifying <code>path</code> means that the whole path to binary will be taken into account, while using <code>filename</code> allows to blacklist a process irrespective of the full path to binary.</p><p>Wildcards are also supported:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code> filename:docker*
 path:/usr/libexec/docker/docker-*
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Also a POSIX regular expressions could be used as follows:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code> regex:/usr/bin/[[:alnum:]]+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="auto-update" tabindex="-1"><a class="header-anchor" href="#auto-update" aria-hidden="true">#</a> Auto update</h4><p>Userspace patching cron job is disabled by default. To enable it, run the following command:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>libcare-cron init
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="usage-in-containers" tabindex="-1"><a class="header-anchor" href="#usage-in-containers" aria-hidden="true">#</a> Usage in containers</h3><p>LibCare supports containers natively, including docker, LXC and other containerization technologies. When run on the host it operates on all processes that are running, including processes present in containers. At the same time there are two ways to use LibCare with containers and each has its own advantages and disadvantages. Let&#39;s go through them.</p><h4 id="disposable-container-servers" tabindex="-1"><a class="header-anchor" href="#disposable-container-servers" aria-hidden="true">#</a> Disposable container servers</h4><p>Disposable container servers are services that are run within a container for limited time and are refreshed periodically, e.g., daily to get the latest security updates. The recommended way to run LibCare with disposable containers is by installing <code>kernelcare</code> on the host, and it will automatically patch all processes libraries in the containers.</p><h4 id="persistent-container-servers" tabindex="-1"><a class="header-anchor" href="#persistent-container-servers" aria-hidden="true">#</a> Persistent container servers</h4><p>Persistent container servers are services that are run in containers the same way as a traditional physical server, i.e., the LXC approach. Although LibCare can run the same way as with disposable containers, it is also possible to install <code>kernelcare</code> within each container and that will enable live patching of the processes of each container individually. That approach enables accurate patching information within each containerized server that can be used by the available vulnerability scanner. When using this approach userspace patching must be disabled on the host using <code>kcarectl --disable-libcare</code>.</p><h3 id="troubleshooting" tabindex="-1"><a class="header-anchor" href="#troubleshooting" aria-hidden="true">#</a> Troubleshooting</h3><h4 id="auditd-logs" tabindex="-1"><a class="header-anchor" href="#auditd-logs" aria-hidden="true">#</a> Auditd logs</h4><p>The LibCare tools heavily use a <code>ptrace</code> syscall and, in case of <code>auditd</code> trace it&#39;s calls, there will be a lot of records in a log. There is a rule that provided by kernelcare package and located here: <code>/etc/audit/rules.d/kernelcare.rules</code>. It will exclue kernelcare processes from audit.</p><p><strong>Note</strong>: no such rule is provided for <code>el6</code> due to old <code>autditd</code> restrictions. There is a command that will add such rule in runtime:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>auditctl -l | grep kcare | cut -d&#39; &#39; -f2- | xargs -t -L1 -r auditctl -d &amp;&amp; pgrep libcare-server | xargs -t -n1 -i auditctl -A exit,never -F arch=b64 -S ptrace -F pid=&quot;{}&quot; -k kcarever | xargs -t -n1 -i auditctl -A exit,never -F arch=b64 -S ptrace -F pid=&quot;{}&quot; -k kcare
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>It removes all currently enabled KernelCare rules and adds a new one by LibCare&#39;s process ID.</p><h3 id="unpatched-library-detector-uchecker" tabindex="-1"><a class="header-anchor" href="#unpatched-library-detector-uchecker" aria-hidden="true">#</a> Unpatched Library Detector (UChecker)</h3><h4 id="description" tabindex="-1"><a class="header-anchor" href="#description" aria-hidden="true">#</a> Description</h4><p>UChecker is a scanner that checks network Linux servers and detects out-of-date libraries both on disk and in memory. KernelCareâ€™s open-source scanner will find false negatives by correctly reporting vulnerable libraries running in memory that could be reported as updated by other scanners.</p><p>The UChecker (originated from &quot;userspace checker&quot;) works with all modern Linux Distributions, it is free and open-source, distributed under the GNU General Public License.</p><h4 id="how-uchecker-works" tabindex="-1"><a class="header-anchor" href="#how-uchecker-works" aria-hidden="true">#</a> How UChecker works</h4><p>This activity diagram shows how UChecker works:</p><p><img src="/images/uchecker.jpg" alt=""></p><h4 id="usage-1" tabindex="-1"><a class="header-anchor" href="#usage-1" aria-hidden="true">#</a> Usage</h4><p>To scan your systems, run the following command:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ curl -s -L https://kernelcare.com/uchecker | sudo python
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>You will receive the following output:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>[*] Process httpd[15516] linked to the `libc-2.17.so` that is not up to date.

You may want to update libraries above and restart corresponding processes.

KernelCare+ allows to resolve such issues with no process downtime. To find 
out more, please, visit https://lp.kernelcare.com/kernelcare-early-access?
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The following information is available in the output:</p><ul><li>Process ID</li><li>Process Name</li></ul><h4 id="troubleshooting-1" tabindex="-1"><a class="header-anchor" href="#troubleshooting-1" aria-hidden="true">#</a> Troubleshooting</h4><p>To verbose output, you can choose a logging level: <code>ERROR</code>, <code>WARNING</code>, <code>INFO</code>, and <code>DEBUG</code>.</p><p>For example:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ curl -s -L https://kernelcare.com/uchecker | sudo LOGLEVEL=debug python
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>To learn more, visit the <a href="https://github.com/cloudlinux/kcare-uchecker" target="_blank" rel="noopener noreferrer">UChecker Github page</a>.</p><h2 id="qemucare" tabindex="-1"><a class="header-anchor" href="#qemucare" aria-hidden="true">#</a> QEMUCare</h2><p>QEMUCare â€“ virtualization patching for cloud providers, VPS hosters, or any other company with QEMU based virtualization systems. It keeps infrastructure patched without disrupting virtual tenantsâ€™ systems.</p><h3 id="how-qemucare-works" tabindex="-1"><a class="header-anchor" href="#how-qemucare-works" aria-hidden="true">#</a> How QEMUCare works</h3><ul><li>An agent is installed on each virtualization host which installs patches directly from the QEMUCare repository.</li><li>In an ePortal environment, your Virtualization Hosts communicate with the QEMUCare ePortal server that acts as an intermediary.</li></ul><h3 id="qemu-patchset-deployment" tabindex="-1"><a class="header-anchor" href="#qemu-patchset-deployment" aria-hidden="true">#</a> QEMU PatchSet Deployment</h3><p>Starting from version 1.25, ePortal supports the QEMU patchset management. It is accessible from the <code>Patches / QEMUcare</code> navigation item. QEMU patches use the same Patch Source credentials, and you don&#39;t need to perform additional configuration.</p><p><img src="/images/eportal-qemu-feed.png" alt=""></p><p>User interface for the QEMU patch management is the same as for KernelCare patches, and you can refer the <a href="https://docs.tuxcare.com/eportal/#patchset-deployment" target="_blank" rel="noopener noreferrer">PatchSet Deployment</a> documentation.</p><h4 id="cli-to-install-the-latest-patchsets" tabindex="-1"><a class="header-anchor" href="#cli-to-install-the-latest-patchsets" aria-hidden="true">#</a> CLI to install the latest patchsets</h4><p>To update the default feed, run the following command:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>kc.eportal qemu update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>To update the <code>test</code> feed, run the following command:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>kc.eportal qemu update --feed test
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>To update all auto-feeds, run the following command:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>kc.eportal qemu auto-update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="cli-to-deploy-patchset-from-archive" tabindex="-1"><a class="header-anchor" href="#cli-to-deploy-patchset-from-archive" aria-hidden="true">#</a> CLI to deploy patchset from archive</h4><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>~$ kc.eportal qemu deploy --help
usage: kc.eportal qemu deploy [-h] [--feed FEED] [--disabled] archive

positional arguments:
  archive      path to archive

optional arguments:
  -h, --help   show this help message and exit
  --feed FEED  feed to deploy archive to
  --disabled   do not enable patchset after deploy
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>For example:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>kc.eportal qemu deploy --feed test /tmp/U20210818_01-qemu.tar.bz2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>This command will deploy and enable the <code>U20210818_01-qemu</code> patchset in to the <code>test</code> feed.</p></div><div class="page-edit"><div class="edit-link"><img src="/global/pen.svg" alt="icon pen"><a href="https://github.com/cloudlinux/cloudlinux-documentation/tree/master/docs/live-patching-services/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a></div></div><div class="back-to-top" data-v-f6429ccb><a class="nav-arrow top back-to-top__link" data-v-f6429ccb><span class="back-to-top__link-span" data-v-f6429ccb>Scroll up</span></a></div><!--[--><!--]--></div><div class="footer footer-default-layout" data-v-9859f1b4><div data-v-9859f1b4><a href="https://cloudlinux.com" data-v-9859f1b4><img src="/global/we-are-cloudlinux.svg" data-v-9859f1b4></a></div><div class="footer-company-title" data-v-9859f1b4>2023. CloudLinux Inc </div><div class="social" data-v-9859f1b4><div class="social_links" data-v-9859f1b4><!--[--><a href="https://cloudlinux.zendesk.com/hc/en-us/categories/360002375940" target="_blank" data-v-9859f1b4>Knowledge base</a><a href="https://www.cloudlinux.com/getting-started-with-cloudlinux-os" target="_blank" data-v-9859f1b4>Forum</a><a href="https://blog.cloudlinux.com/" target="_blank" data-v-9859f1b4>Blog</a><!--]--></div><span class="footer-social-text" data-v-9859f1b4>Stay in touch</span><div class="social-icons-wrapper" data-v-9859f1b4><!--[--><a class="social-icons-link" href="https://www.facebook.com/cloudlinux/" target="_blank" data-v-9859f1b4><img class="social-icons-link-img" src="/footer-social/fb.png" alt="footer logo" data-v-9859f1b4></a><a class="social-icons-link" href="https://twitter.com/cloudlinuxos/" target="_blank" data-v-9859f1b4><img class="social-icons-link-img" src="/footer-social/tw.png" alt="footer logo" data-v-9859f1b4></a><a class="social-icons-link" href="https://linkedin.com/company/cloudlinux" target="_blank" data-v-9859f1b4><img class="social-icons-link-img" src="/footer-social/in.png" alt="footer logo" data-v-9859f1b4></a><a class="social-icons-link" href="https://www.youtube.com/channel/UCZ3YMHWnMP7TaxlXVay5-aw" target="_blank" data-v-9859f1b4><img class="social-icons-link-img" src="/footer-social/ytube.png" alt="footer logo" data-v-9859f1b4></a><!--]--></div></div></div></div><!--]--></div>
    <script type="module" src="/assets/app-d6b3729a.js" defer></script>
  </body>
</html>
